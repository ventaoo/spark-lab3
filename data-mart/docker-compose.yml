version: "3.8"
services:
  datamart:
    build: .
    image: datamart:latest
    volumes:
      - ./data:/data                  # 本地 data 目录，存放 input.csv.gz 和 输出 parquet
    environment:
      - INPUT_PATH=/data/en.openfoodfacts.org.products.csv.gz
      - OUTPUT_PATH=/data/output_parquet
      - SPARK_MASTER=local[*]
    command: [
      "/opt/bitnami/spark/bin/spark-submit",
      "--class", "com.example.datamart.DataMartApp",
      "--master", "local[*]",
      "/opt/app/datamart.jar",
      "--inputPath", "${INPUT_PATH}",
      "--outputPath", "${OUTPUT_PATH}"
    ]